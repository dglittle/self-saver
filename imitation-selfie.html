
<script src="http://code.jquery.com/jquery-2.0.3.min.js"></script>
<script src="http://dglittle.github.io/gl519/index.js"></script>
<script>

function rotate(me, s) {
    me.css({
        '-ms-transform' : s,
        '-moz-transform' : s,
        '-webkit-transform' : s,
        '-o-transform' : s
    })
    return me
}

$(function () {
	var ii = $('<input type="file" accept="image/*" capture="camera"/>').change(function () {
	    var i = ii[0]
	    var url = $(this).val()
	    console.log('url2', i.files[0])
	    if (i.files && i.files[0]) {
	        var r = new FileReader()
	        r.onload = function (e) {
	            var img = new Image()
	            img.onload = function () {
            	    var w = img.width
            	    var h = img.height
                    var c = $('<canvas/>').attr('width', w).attr('height', h)
                    var g = c[0].getContext('2d')
                    g.drawImage(img, 0, 0, w, h)
                    $('body').append(c)
	                
	            }
	            img.src = e.target.result
	        }
	        r.readAsDataURL(i.files[0])
	    }
	})
	$('body').append(ii)

	
//   $('#upload').change(function(){
//     var url = $(this).val();
//     var ext = url.substring(url.lastIndexOf('.') + 1).toLowerCase();
//     if (input.files && input.files[0]&& (ext == "gif" || ext == "png" || ext == "jpeg" || ext == "jpg")) 
//      {
//         var reader = new FileReader();

//         reader.onload = function (e) {
//           $('#img').attr('src', e.target.result);
//         }
//       reader.readAsDataURL(input.files[0]);
//     }
//     else
//     {
//       $('#img').attr('src', '/assets/no_preview.png');
//     }
//   });	

	
    // navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia
    // window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL
    // window.requestAnimationFrame = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (cb) { window.setTimeout(cb, 1000 / 60) }
        
    // if (navigator.getUserMedia) {
    //     var video = $('<video/>')
    //     rotate(video, 'rotateY(180deg)')
    //     video.attr('width', '100')

    //     $('body').append(video)
    //     video = video[0]
    //     navigator.getUserMedia({video: true}, function (stream) {
    //         if (video.mozSrcObject !== undefined)
    //             video.mozSrcObject = stream
    //         else
    //             video.src = (window.URL && window.URL.createObjectURL(stream)) || stream
    //         video.play()
    //     }, function () {});
    // 	$('body').append($('<button/>').text('snapshot').click(function () {
    // 	    var w = video.videoWidth
    // 	    var h = video.videoHeight
    //         var c = $('<canvas/>').attr('width', w).attr('height', h)
    //         var g = c[0].getContext('2d')
    //         g.drawImage(video, 0, 0, w, h)
    //         $('body').append(c)
    // 	}))
    // }

})

</script>
